<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Agentic TotChef: Software Architectures, Patterns, and Best Practices | It&#39;s worth a Coke</title>
<meta name="keywords" content="AI, GenAI, Agent, Ollama, Python">
<meta name="description" content="This article explores software architecture, design patterns, and best practices for building scalable and maintainable AI agents, using a case study called &#39;TotChef&#39; that generates weekly menus for a 1‑year‑old baby.">
<meta name="author" content="carmelolg">
<link rel="canonical" href="https://carmelolg.github.io/it-is-worth-a-coke/posts/ai-agentic-flow-architecture/">
<link crossorigin="anonymous" href="/it-is-worth-a-coke/assets/css/stylesheet.da3211e5ef867bf2b75fd5a6515cfed7195c011e8ab735694e203810a827097b.css" integrity="sha256-2jIR5e&#43;Ge/K3X9WmUVz&#43;1xlcAR6KtzVpTiA4EKgnCXs=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://carmelolg.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://carmelolg.github.io/it-is-worth-a-coke/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://carmelolg.github.io/it-is-worth-a-coke/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://carmelolg.github.io/it-is-worth-a-coke/apple-touch-icon.png">
<link rel="mask-icon" href="https://carmelolg.github.io/it-is-worth-a-coke/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://carmelolg.github.io/it-is-worth-a-coke/posts/ai-agentic-flow-architecture/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script><meta property="og:url" content="https://carmelolg.github.io/it-is-worth-a-coke/posts/ai-agentic-flow-architecture/">
  <meta property="og:site_name" content="It&#39;s worth a Coke">
  <meta property="og:title" content="Agentic TotChef: Software Architectures, Patterns, and Best Practices">
  <meta property="og:description" content="This article explores software architecture, design patterns, and best practices for building scalable and maintainable AI agents, using a case study called &#39;TotChef&#39; that generates weekly menus for a 1‑year‑old baby.">
  <meta property="og:locale" content="en-EN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2026-02-16T00:00:00+00:00">
    <meta property="article:modified_time" content="2026-02-16T00:00:00+00:00">
    <meta property="article:tag" content="AI">
    <meta property="article:tag" content="GenAI">
    <meta property="article:tag" content="Agent">
    <meta property="article:tag" content="Ollama">
    <meta property="article:tag" content="Python">
      <meta property="og:image" content="https://carmelolg.github.io/it-is-worth-a-coke/images/Tokio.jpeg">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://carmelolg.github.io/it-is-worth-a-coke/images/Tokio.jpeg">
<meta name="twitter:title" content="Agentic TotChef: Software Architectures, Patterns, and Best Practices">
<meta name="twitter:description" content="This article explores software architecture, design patterns, and best practices for building scalable and maintainable AI agents, using a case study called &#39;TotChef&#39; that generates weekly menus for a 1‑year‑old baby.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://carmelolg.github.io/it-is-worth-a-coke/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Agentic TotChef: Software Architectures, Patterns, and Best Practices",
      "item": "https://carmelolg.github.io/it-is-worth-a-coke/posts/ai-agentic-flow-architecture/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Agentic TotChef: Software Architectures, Patterns, and Best Practices",
  "name": "Agentic TotChef: Software Architectures, Patterns, and Best Practices",
  "description": "This article explores software architecture, design patterns, and best practices for building scalable and maintainable AI agents, using a case study called 'TotChef' that generates weekly menus for a 1‑year‑old baby.",
  "keywords": [
    "AI", "GenAI", "Agent", "Ollama", "Python"
  ],
  "articleBody": "Introduction AI-assisted source code development is now growing at an exponential pace. The capabilities of LLMs provided by various vendors make it possible, even in Zero-Shot Learning mode, to generate high-quality source code with a remarkable level of abstraction and complexity. The results, surprisingly good in my opinion, come from using so‑called AI Agents (in ReAct mode and supported by MCP Servers), which significantly boost developer productivity.\nBut let’s pause for a moment. While the world is overflowing with enthusiasm and expectations, it is important to remember that source code generation by an LLM (agentic or not) is only one part of the software development process. The demand for Software Architects will remain high, precisely to avoid building software that, while technically working, is underperforming, hard to maintain, scale, and extend.\nWe have all worked on software projects which, although functional, carried a huge and hard‑to‑control technical debt. Time pressure and budget constraints often pushed quality down, leading to quick and dirty solutions that solved the immediate problem but increased the amount of inefficient source code and, in some cases, introduced security vulnerabilities.\nThe question is: in a phase where technologies are evolving so rapidly, can we really afford to make the same mistake again?\nThe answer must be no, also because, beyond technical debt, we now have ongoing costs to consider (AI service providers, vector databases, and more) that are anything but negligible.\nIf we use AI agents without a solid foundation in software design, we risk improvising architectures that work at first glance, but are neither scalable nor maintainable. Among the risks, we find:\n“Over-engineering”: designing systems that are far too complex for the problem at hand, with a consequent increase in the project’s ongoing costs. Inadequate performance due to suboptimal agent design, which can lead to longer response times and a disappointing user experience. Goal In this article, I will walk you through an exercise I carried out to experiment with a few agentic design patterns. The exercise is built around a small demo application called Agentic TotChef, whose goal is to generate a weekly menu for a 1‑year‑old girl, taking into account what she eats at daycare, recipes from the family cookbook, and what is currently available at home.\nThis experiment helped me understand both limitations and benefits, including:\nThe use of SLMs (Small Language Models) to keep costs under control while still achieving satisfying results The adoption of design patterns and best practices to architect AI agents with solid performance characteristics Small Language Models: limits and benefits While it is true that large language models (LLMs) like GPT‑5, Gemini, Claude, Grok, and others offer extraordinary capabilities, it is equally true that Small Language Models (SLMs) are gaining traction thanks to their efficiency and lower cost.\nSLMs, such as those provided by Ollama, are designed to be lighter and cheaper to run, making them ideal for focused applications that do not need the full power of a massive LLM.\nSome key advantages:\nLower cost: SLMs are generally cheaper to use than LLMs, which makes them accessible even for projects with limited budgets. Efficiency: SLMs can be faster at generating responses, especially for well‑framed tasks that do not require deep, open‑ended reasoning. Customization: By injecting task‑specific context, you can obtain more relevant and accurate outputs, squeezing the most out of the SLM. However, it is important to acknowledge their limitations, such as a reduced ability to handle very complex contexts or to generate highly creative, nuanced answers. So the choice between LLM and SLM should always depend on the project’s specific needs and the goals you want to achieve.\nIn my case, for the TotChef project, I chose qwen3‑8b, which proved more than sufficient to generate weekly menus that were both accurate and relevant. We are obviously talking about medium‑low complexity requirements and modest hardware. Still, it was enough to achieve a satisfying outcome with acceptable response times.\nAgentic Design Patterns: what they are During an intense reading session, I stumbled upon a very interesting book: Agentic Design Pattern by Antonio Gulli, Engineering Director at Google. The book describes a set of design patterns for building AI agents, with a particular focus on structuring agent workflows, handling memory, and interacting with the external environment.\nAs I was reading it, my mind immediately went to the GoF and their idea of standardizing source code production. In a way, the patterns described in Agentic Design Pattern represent an attempt to standardize the design of AI agents, offering proven solutions to recurring problems you encounter while building agentic systems.\nIn my sample project, Agentic TotChef, I did not have much room to apply a wide range of patterns, so I started by experimenting with the first two:\nPrompt Chaining: this pattern breaks down a complex task into a series of simpler steps, each handled by a dedicated AI agent. Parallelization: this pattern runs multiple AI agents in parallel to complete a task, improving overall performance and reducing response times. For me it was both a fun game and a practical way to better understand the limits and advantages of these design patterns, and how they can be applied in real projects to improve the maintainability of AI agents.\nAgentic TotChef: software architecture Agentic TotChef is a little toy project that I built for several reasons:\nTo test the design patterns from Agentic Design Pattern To see whether an SLM could deliver satisfying results To write boilerplate code (the part highlighted in purple in the diagram) for the design of OAIA - OrchestrAI Architecture, a reusable template for future projects. The diagram below illustrates the high-level architecture of Agentic TotChef:\nThe most interesting part of this tiny software architecture is the file Runner, highlighted in the green box on the right: it shows all the calls to qwen3‑8b and the interactions between the various agents.\nIn particular, you can clearly see how the Prompt Chaining design pattern is used to split the complex task of generating a weekly menu into a sequence of simpler steps, each implemented by a dedicated AI agent.\nThe Parallelization pattern, on the other hand, is used to run two independent steps in parallel:\nFetching the daycare menu and generating a lunch plan from Monday to Friday Creating an evening‑meal menu for the full week and weekend, taking into account what is available at home and the family recipes. While the first pattern helped achieve a clearly better output compared to a more naive design, the second allowed me to increase the speedup of the weekly menu generation process, reducing response times and improving the overall user experience.\nNote: I am not covering the small web application that lets you chat with TotChef, simply because it does not include any particularly interesting architectural elements: it is just an interface used to test the AI agents’ outputs at the various steps.\nAgentic TotChef: code snippet In this Python code example, each object that defines a step (for example KindergartenMenuStep) implements an execute method that runs the given step, interacting (via LLMExecutor) with qwen3‑8b and returning a StepResult object containing the step output and execution status.\nYou can find the full code here\n# Step 1: Kindergarten menu kg_step = KindergartenMenuStep() kg_step_output: StepResult = StepResult(step_id=kg_step.step_id, result=\"\") # Step 2: Home menu home_step = HomeMenuStep() home_step_output = StepResult(step_id=home_step.step_id, result=\"\") # Execute both steps in parallel with ProcessPoolExecutor() as executor: futures = [ executor.submit(kg_step.execute), executor.submit(home_step.execute) ] for future in futures: single_result = future.result() if single_result is not None and single_result.is_success(): if single_result.step_id == kg_step.step_id: kg_step_output: StepResult = single_result elif single_result.step_id == home_step.step_id: home_step_output: StepResult = single_result # Step 3: Merge menus merge_step = MergeMenuStep() merge_step_output: StepResult = merge_step.execute(kg_step_output.result, home_step_output.result) # Step 4: Shopping list shopping_list_step = ShoppingListStep() shopping_list_output: StepResult = shopping_list_step.execute(merge_step_output.result) # Add step that create a Markdown file with the merged menu and shopping list create_md_step = CreateMarkdownStep() create_md_output: StepResult = create_md_step.execute(merge_step_output.result, shopping_list_output.result) if create_md_output is not None and create_md_output.is_success(): TotChef.log_element(f\"Markdown created: {create_md_output.result}\") else: TotChef.log_element(\"Failed to create markdown file\") The output is a Markdown file that includes the weekly menu and the related shopping list.\nHere an example # Weekly Menu and Shopping List ## Menù | Day | Lunch | Dinner | |-----------|------------------------------------------------------------------------|------------------------------------------------------------------------| | Monday | First Course: Penne al ragù\nMain Course: Omelette al forno\nSide: Carote prezzemolate | First Course: Riso sugo e piselli\nMain Course: Nasello con carote in padella\nSide: Zucchine | | Tuesday | First Course: Minestrina in brodo vegetale\nMain Course: Spezzatino di tacchino in umido\nSide: Purea di patate | First Course: Pasta al ragù\nMain Course: Polpette di carne\nSide: Fagiolini | | Wednesday | First Course: Passato di lenticchie con pasta\nMain Course: Stracchino\nSide: Costine all'olio | First Course: Pasta alla zucca\nMain Course: Orata in friggitrice ad aria\nSide: Costine | | Thursday | First Course: Risotto alla parmigiana\nMain Course: Bocconcini di pollo alla pizzaiola\nSide: Finocchi lessi | First Course: Pasta alla crema di ceci\nMain Course: Philadelphia\nSide: Verza | | Friday | First Course: Farfalle al pomodoro\nMain Course: Filetto di pesce al limone\nSide: Broccoli all'olio | First Course: Pasta e patate\nMain Course: Formaggio fresco\nSide: Cavolo nero | | Saturday | First Course: Pasta al pomodoro\nMain Course: Polpette di ceci\nSide: Zucchine | First Course: Riso sugo e piselli\nMain Course: Ricotta fresca\nSide: Spinaci | | Sunday | First Course: Pasta al cavolo nero\nMain Course: Frittata\nSide: Fagiolini | First Course: Pasta alla crema di zucchine\nMain Course: Orata in friggitrice ad aria\nSide: Cavolfiore | ## Shopping List ### Fruits and Vegetables - Carote: 1 kg - Zucchine: 1 kg - Fagiolini: 1 kg - Broccoli: 1 kg - Finocchi: 1 kg - Cavolfiore: 1 kg - Cavolo nero: 1 kg - Spinaci: 1 kg - Piselli: 1 kg - Verza: 1 kg - Patate: 1 kg - Lenticchie: 1 kg - Riso: 1 kg - Cipolle: 1 kg - Aglio: 1 kg - Prezzemolo: 1 mazzetto - Basilico: 1 mazzetto - Timo: 1 mazzetto - Zafferano: 1 cucchiaino ### Proteins (Meat, Fish, Eggs, etc.) - Manzo: 1 kg - Tacchino: 1 kg - Pollo: 1 kg - Pesce (filetto): 1 kg - Orata: 1 kg - Uova: 12 pezzi - Stracchino: 200 g - Philadelphia: 200 g - Formaggio fresco: 200 g - Ricotta fresca: 200 g - Bocconcini di pollo: 1 kg ### Carbohydrates (Pasta, Rice, Bread, etc.) - Penne: 500 g - Farfalle: 500 g - Pasta alla crema di ceci: 500 g - Pasta alla zucca: 500 g - Pasta al cavolo nero: 500 g - Pasta alla crema di zucchine: 500 g - Riso: 1 kg - Pane: 1 kg ### Lacteos (Milk, Cheese, Yogurt, etc.) - Latte: 1 litro - Yogurt greco: 1 litro - Formaggio grattugiato: 100 g - Burro: 100 g ### Legumes - Ceci: 500 g - Lenticchie: 1 kg - Fagioli: 500 g ### Other (Oils, Spices, etc.) - Olio d'oliva: 1 litro - Sale: 1 kg - Pepe nero: 100 g - Zucchero: 1 kg - Aceto balsamico: 100 ml - Senape: 100 ml - Panna: 200 ml - Salsa di soia: 100 ml - Vino bianco: 1 litro - Olio per friggere: 500 ml - Farina: 500 g - Cioccolato fondente: 100 g - Cacao in polvere: 100 g - Caffè: 100 g - Zucchero di canna: 1 kg - Miele: 100 g Conclusions In this article, I shared an exercise focused on experimenting with a few agentic design patterns using the SLM qwen3-8b to generate a weekly menu suitable for a one-year-old child.\nThis experiment helped me identify both the strengths and limitations of these patterns, showing how they can be adopted in real-world scenarios to improve the maintainability and robustness of AI agents.\nIn particular, the Prompt Chaining pattern proved effective in breaking down a complex task into a sequence of more manageable steps, each handled by a specialized agent. The Parallelization pattern, on the other hand, made it possible to execute two independent steps simultaneously, boosting performance and noticeably reducing response time.\nThe resulting speedup achieved through this architecture was significant (around 1.5× for this use case) considering that only the two most demanding steps were run in parallel. Previous implementations, which lacked a clear separation of responsibilities and relied on monolithic agents, instead showed undesired behaviors like infinite loops and hallucinations.\nFor the development of Agentic TotChef, I used Python, but agentic design patterns are language-agnostic concepts that can be applied to any type of agent or AI model.\nThis project also gave me the chance to explore the world of vibe coding more deeply, thanks to the valuable insights of @gregoriolagamba, Solution Architect at Plenitude, who introduced me to agentic programming tools directly on GitHub.\n",
  "wordCount" : "2097",
  "inLanguage": "en",
  "image": "https://carmelolg.github.io/it-is-worth-a-coke/images/Tokio.jpeg","datePublished": "2026-02-16T00:00:00Z",
  "dateModified": "2026-02-16T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "carmelolg"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://carmelolg.github.io/it-is-worth-a-coke/posts/ai-agentic-flow-architecture/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "It's worth a Coke",
    "logo": {
      "@type": "ImageObject",
      "url": "https://carmelolg.github.io/favicon.ico"
    }
  }
}
</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://carmelolg.github.io/it-is-worth-a-coke/" accesskey="h" title="It&#39;s worth a Coke (Alt + H)">It&#39;s worth a Coke</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://carmelolg.github.io/it-is-worth-a-coke/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://carmelolg.github.io/it-is-worth-a-coke/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://carmelolg.github.io/it-is-worth-a-coke/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://carmelolg.github.io/" title="Who I am">
                    <span>Who I am</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Agentic TotChef: Software Architectures, Patterns, and Best Practices
    </h1>
    <div class="post-description">
      This article explores software architecture, design patterns, and best practices for building scalable and maintainable AI agents, using a case study called &#39;TotChef&#39; that generates weekly menus for a 1‑year‑old baby.
    </div>
    <div class="post-meta"><span title='2026-02-16 00:00:00 +0000 UTC'>February 16, 2026</span>&nbsp;·&nbsp;<span>10 min</span>&nbsp;·&nbsp;<span>carmelolg</span>

</div>
  </header> 
  <div class="post-content"><h1 id="introduction">Introduction<a hidden class="anchor" aria-hidden="true" href="#introduction">#</a></h1>
<p>AI-assisted source code development is now growing at an exponential pace.
The capabilities of LLMs provided by various vendors make it possible, even in <a href="https://www.promptingguide.ai/techniques/zeroshot">Zero-Shot Learning</a> mode, to generate high-quality source code with a remarkable level of abstraction and complexity.
The results, surprisingly good in my opinion, come from using so‑called <strong>AI Agents</strong> (in <a href="https://www.promptingguide.ai/techniques/react">ReAct</a> mode and supported by <a href="https://modelcontextprotocol.io/docs/getting-started/intro">MCP Servers</a>), which significantly boost developer productivity.</p>
<p>But let’s pause for a moment. While the world is overflowing with enthusiasm and expectations, it is important to remember that source code generation by an LLM (agentic or not)
<strong>is only one part of the software development process</strong>. The demand for Software Architects will remain high, precisely to avoid building software
that, while technically working, is underperforming, hard to maintain, scale, and extend.</p>
<p>We have all worked on software projects which, although functional, carried a huge and hard‑to‑control technical debt.
Time pressure and budget constraints often pushed quality down, leading to <em>quick and dirty</em> solutions that solved the immediate problem but
increased the amount of inefficient source code and, in some cases, introduced security vulnerabilities.</p>
<p><strong>The question is: in a phase where technologies are evolving so rapidly, can we really afford to make the same mistake again?</strong></p>
<p><strong>The answer must be no</strong>, also because, beyond technical debt, we now have ongoing costs to consider (AI service providers, vector databases, and more) that are anything but negligible.</p>
<p>If we use AI agents without a solid foundation in software design, we risk improvising architectures that work at first glance, but are neither scalable nor maintainable.
Among the risks, we find:</p>
<ul>
<li>&ldquo;Over-engineering&rdquo;: designing systems that are far too complex for the problem at hand, with a consequent increase in the project’s ongoing costs.</li>
<li>Inadequate performance due to suboptimal agent design, which can lead to longer response times and a disappointing user experience.</li>
</ul>
<h1 id="goal">Goal<a hidden class="anchor" aria-hidden="true" href="#goal">#</a></h1>
<p>In this article, I will walk you through an exercise I carried out to experiment with a few <em>agentic design patterns</em>.
The exercise is built around a small demo application called <strong><a href="https://github.com/org-carmelolg-private-labs/agentic-totchef">Agentic TotChef</a></strong>, whose goal is to generate
a weekly menu for a 1‑year‑old girl, taking into account what she eats at daycare, recipes from the family cookbook, and what is currently available at home.</p>
<p>This experiment helped me understand both limitations and benefits, including:</p>
<ul>
<li>The use of SLMs (Small Language Models) to keep costs under control while still achieving satisfying results</li>
<li>The adoption of design patterns and best practices to architect AI agents with solid performance characteristics</li>
</ul>
<h1 id="small-language-models-limits-and-benefits">Small Language Models: limits and benefits<a hidden class="anchor" aria-hidden="true" href="#small-language-models-limits-and-benefits">#</a></h1>
<p>While it is true that large language models (LLMs) like GPT‑5, Gemini, Claude, Grok, and others offer extraordinary capabilities,
it is equally true that Small Language Models (SLMs) are gaining traction thanks to their efficiency and lower cost.</p>
<p>SLMs, such as those provided by Ollama, are designed to be lighter and cheaper to run, making them ideal for focused applications
that do not need the full power of a massive LLM.</p>
<p>Some key advantages:</p>
<ul>
<li><strong>Lower cost</strong>: SLMs are generally cheaper to use than LLMs, which makes them accessible even for projects with limited budgets.</li>
<li><strong>Efficiency</strong>: SLMs can be faster at generating responses, especially for well‑framed tasks that do not require deep, open‑ended reasoning.</li>
<li><strong>Customization</strong>: By injecting task‑specific context, you can obtain more relevant and accurate outputs, squeezing the most out of the SLM.</li>
</ul>
<p>However, it is important to acknowledge their limitations, such as a reduced ability to handle very complex contexts or to generate highly creative, nuanced answers.
So the choice between LLM and SLM should always depend on the project’s specific needs and the goals you want to achieve.</p>
<p>In my case, for the TotChef project, I chose <strong>qwen3‑8b</strong>, which proved more than sufficient to generate weekly menus that were both accurate and relevant.
We are obviously talking about medium‑low complexity requirements and modest hardware.
Still, it was enough to achieve a satisfying outcome with acceptable response times.</p>
<h1 id="agentic-design-patterns-what-they-are">Agentic Design Patterns: what they are<a hidden class="anchor" aria-hidden="true" href="#agentic-design-patterns-what-they-are">#</a></h1>
<p>During an intense reading session, I stumbled upon a very interesting book: <a href="https://search.worldcat.org/it/title/1547934185">Agentic Design Pattern by Antonio Gulli</a>, Engineering Director at Google. The book describes a set of design patterns for building AI agents, with a particular focus on structuring agent workflows, handling memory, and interacting with the external environment.</p>
<p>As I was reading it, my mind immediately went to the <a href="https://en.wikipedia.org/wiki/Design_Patterns">GoF</a> and their idea of standardizing source code production. In a way, the patterns described in Agentic Design Pattern represent an attempt to standardize the design of AI agents, offering proven solutions to recurring problems you encounter while building agentic systems.</p>
<p>In my sample project, <a href="https://github.com/org-carmelolg-private-labs/agentic-totchef">Agentic TotChef</a>, I did not have much room to apply a wide range of patterns, so I started by experimenting with the first two:</p>
<ul>
<li><strong>Prompt Chaining</strong>: this pattern breaks down a complex task into a series of simpler steps, each handled by a dedicated AI agent.</li>
<li><strong>Parallelization</strong>: this pattern runs multiple AI agents in parallel to complete a task, improving overall performance and reducing response times.</li>
</ul>
<p>For me it was both a fun game and a practical way to better understand the limits and advantages of these design patterns, and how they can be applied in real projects to improve the maintainability of AI agents.</p>
<h1 id="agentic-totchef-software-architecture">Agentic TotChef: software architecture<a hidden class="anchor" aria-hidden="true" href="#agentic-totchef-software-architecture">#</a></h1>
<p><a href="https://github.com/org-carmelolg-private-labs/agentic-totchef">Agentic TotChef</a> is a little toy project that I built for several reasons:</p>
<ul>
<li>To test the design patterns from Agentic Design Pattern</li>
<li>To see whether an SLM could deliver satisfying results</li>
<li>To write <em>boilerplate</em> code (the part highlighted in purple in the diagram) for the design of <a href="https://github.com/carmelolg/OAIA">OAIA - OrchestrAI Architecture</a>, a reusable template for future projects.</li>
</ul>
<p>The diagram below illustrates the high-level architecture of Agentic TotChef:</p>
<p><img alt="Agentic TotChef Architecture" loading="lazy" src="/it-is-worth-a-coke/posts/ai-agentic-flow-architecture/totchef-arch.png"></p>
<p>The most interesting part of this tiny software architecture is the file <strong>Runner</strong>, highlighted in the green box on the right: it shows all the calls to <strong>qwen3‑8b</strong> and the interactions between the various agents.</p>
<p>In particular, you can clearly see how the <strong>Prompt Chaining</strong> design pattern is used to split the complex task of generating a weekly menu into a sequence of simpler steps, each implemented by a dedicated AI agent.</p>
<p>The <strong>Parallelization</strong> pattern, on the other hand, is used to run two independent steps in parallel:</p>
<ul>
<li>Fetching the daycare menu and generating a lunch plan from Monday to Friday</li>
<li>Creating an evening‑meal menu for the full week and weekend, taking into account what is available at home and the family recipes.</li>
</ul>
<p>While the first pattern helped achieve a clearly better output compared to a more naive design, the second allowed me to increase the speedup of the weekly menu generation process, reducing response times and improving the overall user experience.</p>
<p><strong>Note</strong>: I am not covering the small web application that lets you chat with TotChef, simply because it does not include any particularly interesting architectural elements: it is just an interface used to test the AI agents’ outputs at the various steps.</p>
<h1 id="agentic-totchef-code-snippet">Agentic TotChef: code snippet<a hidden class="anchor" aria-hidden="true" href="#agentic-totchef-code-snippet">#</a></h1>
<blockquote>
<p>In this Python code example, each object that defines a step (for example <code>KindergartenMenuStep</code>) implements an <code>execute</code> method that runs the given step, interacting (via <code>LLMExecutor</code>) with <em>qwen3‑8b</em> and returning a <code>StepResult</code> object containing the step output and execution status.</p>
</blockquote>
<p><a href="https://github.com/org-carmelolg-private-labs/agentic-totchef/">You can find the full code here</a></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># Step 1: Kindergarten menu</span>
</span></span><span class="line"><span class="cl"><span class="n">kg_step</span> <span class="o">=</span> <span class="n">KindergartenMenuStep</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">kg_step_output</span><span class="p">:</span> <span class="n">StepResult</span> <span class="o">=</span> <span class="n">StepResult</span><span class="p">(</span><span class="n">step_id</span><span class="o">=</span><span class="n">kg_step</span><span class="o">.</span><span class="n">step_id</span><span class="p">,</span> <span class="n">result</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Step 2: Home menu</span>
</span></span><span class="line"><span class="cl"><span class="n">home_step</span> <span class="o">=</span> <span class="n">HomeMenuStep</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">home_step_output</span> <span class="o">=</span> <span class="n">StepResult</span><span class="p">(</span><span class="n">step_id</span><span class="o">=</span><span class="n">home_step</span><span class="o">.</span><span class="n">step_id</span><span class="p">,</span> <span class="n">result</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Execute both steps in parallel</span>
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="n">ProcessPoolExecutor</span><span class="p">()</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">futures</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="n">executor</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">kg_step</span><span class="o">.</span><span class="n">execute</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="n">executor</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">home_step</span><span class="o">.</span><span class="n">execute</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">future</span> <span class="ow">in</span> <span class="n">futures</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">single_result</span> <span class="o">=</span> <span class="n">future</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">single_result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">single_result</span><span class="o">.</span><span class="n">is_success</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">single_result</span><span class="o">.</span><span class="n">step_id</span> <span class="o">==</span> <span class="n">kg_step</span><span class="o">.</span><span class="n">step_id</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">kg_step_output</span><span class="p">:</span> <span class="n">StepResult</span> <span class="o">=</span> <span class="n">single_result</span>
</span></span><span class="line"><span class="cl">            <span class="k">elif</span> <span class="n">single_result</span><span class="o">.</span><span class="n">step_id</span> <span class="o">==</span> <span class="n">home_step</span><span class="o">.</span><span class="n">step_id</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">home_step_output</span><span class="p">:</span> <span class="n">StepResult</span> <span class="o">=</span> <span class="n">single_result</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Step 3: Merge menus</span>
</span></span><span class="line"><span class="cl"><span class="n">merge_step</span> <span class="o">=</span> <span class="n">MergeMenuStep</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">merge_step_output</span><span class="p">:</span> <span class="n">StepResult</span> <span class="o">=</span> <span class="n">merge_step</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">kg_step_output</span><span class="o">.</span><span class="n">result</span><span class="p">,</span> <span class="n">home_step_output</span><span class="o">.</span><span class="n">result</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Step 4: Shopping list</span>
</span></span><span class="line"><span class="cl"><span class="n">shopping_list_step</span> <span class="o">=</span> <span class="n">ShoppingListStep</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">shopping_list_output</span><span class="p">:</span> <span class="n">StepResult</span> <span class="o">=</span> <span class="n">shopping_list_step</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">merge_step_output</span><span class="o">.</span><span class="n">result</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Add step that create a Markdown file with the merged menu and shopping list</span>
</span></span><span class="line"><span class="cl"><span class="n">create_md_step</span> <span class="o">=</span> <span class="n">CreateMarkdownStep</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">create_md_output</span><span class="p">:</span> <span class="n">StepResult</span> <span class="o">=</span> <span class="n">create_md_step</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">merge_step_output</span><span class="o">.</span><span class="n">result</span><span class="p">,</span> <span class="n">shopping_list_output</span><span class="o">.</span><span class="n">result</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">create_md_output</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">create_md_output</span><span class="o">.</span><span class="n">is_success</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">TotChef</span><span class="o">.</span><span class="n">log_element</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Markdown created: </span><span class="si">{</span><span class="n">create_md_output</span><span class="o">.</span><span class="n">result</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">TotChef</span><span class="o">.</span><span class="n">log_element</span><span class="p">(</span><span class="s2">&#34;Failed to create markdown file&#34;</span><span class="p">)</span>
</span></span></code></pre></div><p>The output is a Markdown file that includes the weekly menu and the related shopping list.</p>
<details>
    <summary>Here an example</summary>
<pre><code># Weekly Menu and Shopping List
## Menù

| Day       | Lunch                                                                 | Dinner                                                                 |
|-----------|------------------------------------------------------------------------|------------------------------------------------------------------------|
| Monday    | First Course: Penne al ragù&lt;br&gt;Main Course: Omelette al forno&lt;br&gt;Side: Carote prezzemolate | First Course: Riso sugo e piselli&lt;br&gt;Main Course: Nasello con carote in padella&lt;br&gt;Side: Zucchine |
| Tuesday   | First Course: Minestrina in brodo vegetale&lt;br&gt;Main Course: Spezzatino di tacchino in umido&lt;br&gt;Side: Purea di patate | First Course: Pasta al ragù&lt;br&gt;Main Course: Polpette di carne&lt;br&gt;Side: Fagiolini |
| Wednesday | First Course: Passato di lenticchie con pasta&lt;br&gt;Main Course: Stracchino&lt;br&gt;Side: Costine all'olio | First Course: Pasta alla zucca&lt;br&gt;Main Course: Orata in friggitrice ad aria&lt;br&gt;Side: Costine |
| Thursday  | First Course: Risotto alla parmigiana&lt;br&gt;Main Course: Bocconcini di pollo alla pizzaiola&lt;br&gt;Side: Finocchi lessi | First Course: Pasta alla crema di ceci&lt;br&gt;Main Course: Philadelphia&lt;br&gt;Side: Verza |
| Friday    | First Course: Farfalle al pomodoro&lt;br&gt;Main Course: Filetto di pesce al limone&lt;br&gt;Side: Broccoli all'olio | First Course: Pasta e patate&lt;br&gt;Main Course: Formaggio fresco&lt;br&gt;Side: Cavolo nero |
| Saturday  | First Course: Pasta al pomodoro&lt;br&gt;Main Course: Polpette di ceci&lt;br&gt;Side: Zucchine | First Course: Riso sugo e piselli&lt;br&gt;Main Course: Ricotta fresca&lt;br&gt;Side: Spinaci |
| Sunday    | First Course: Pasta al cavolo nero&lt;br&gt;Main Course: Frittata&lt;br&gt;Side: Fagiolini | First Course: Pasta alla crema di zucchine&lt;br&gt;Main Course: Orata in friggitrice ad aria&lt;br&gt;Side: Cavolfiore |

## Shopping List

### Fruits and Vegetables  
- Carote: 1 kg  
- Zucchine: 1 kg  
- Fagiolini: 1 kg  
- Broccoli: 1 kg  
- Finocchi: 1 kg  
- Cavolfiore: 1 kg  
- Cavolo nero: 1 kg  
- Spinaci: 1 kg  
- Piselli: 1 kg  
- Verza: 1 kg  
- Patate: 1 kg  
- Lenticchie: 1 kg  
- Riso: 1 kg  
- Cipolle: 1 kg  
- Aglio: 1 kg  
- Prezzemolo: 1 mazzetto  
- Basilico: 1 mazzetto  
- Timo: 1 mazzetto  
- Zafferano: 1 cucchiaino  

### Proteins (Meat, Fish, Eggs, etc.)  
- Manzo: 1 kg  
- Tacchino: 1 kg  
- Pollo: 1 kg  
- Pesce (filetto): 1 kg  
- Orata: 1 kg  
- Uova: 12 pezzi  
- Stracchino: 200 g  
- Philadelphia: 200 g  
- Formaggio fresco: 200 g  
- Ricotta fresca: 200 g  
- Bocconcini di pollo: 1 kg  

### Carbohydrates (Pasta, Rice, Bread, etc.)  
- Penne: 500 g  
- Farfalle: 500 g  
- Pasta alla crema di ceci: 500 g  
- Pasta alla zucca: 500 g  
- Pasta al cavolo nero: 500 g  
- Pasta alla crema di zucchine: 500 g  
- Riso: 1 kg  
- Pane: 1 kg  

### Lacteos (Milk, Cheese, Yogurt, etc.)  
- Latte: 1 litro  
- Yogurt greco: 1 litro  
- Formaggio grattugiato: 100 g  
- Burro: 100 g  

### Legumes  
- Ceci: 500 g  
- Lenticchie: 1 kg  
- Fagioli: 500 g  

### Other (Oils, Spices, etc.)  
- Olio d'oliva: 1 litro  
- Sale: 1 kg  
- Pepe nero: 100 g  
- Zucchero: 1 kg  
- Aceto balsamico: 100 ml  
- Senape: 100 ml  
- Panna: 200 ml  
- Salsa di soia: 100 ml  
- Vino bianco: 1 litro  
- Olio per friggere: 500 ml  
- Farina: 500 g  
- Cioccolato fondente: 100 g  
- Cacao in polvere: 100 g  
- Caffè: 100 g  
- Zucchero di canna: 1 kg  
- Miele: 100 g
</code></pre>
</details>
<h1 id="conclusions">Conclusions<a hidden class="anchor" aria-hidden="true" href="#conclusions">#</a></h1>
<p>In this article, I shared an exercise focused on experimenting with a few <em>agentic design patterns</em> using the SLM <strong>qwen3-8b</strong> to generate a weekly menu suitable for a one-year-old child.</p>
<p>This experiment helped me identify both the strengths and limitations of these patterns, showing how they can be adopted in real-world scenarios to improve the maintainability and robustness of AI agents.</p>
<p>In particular, the <strong>Prompt Chaining</strong> pattern proved effective in breaking down a complex task into a sequence of more manageable steps, each handled by a specialized agent. The <strong>Parallelization</strong> pattern, on the other hand, made it possible to execute two independent steps simultaneously, boosting performance and noticeably reducing response time.</p>
<p>The resulting speedup achieved through this architecture was significant (around 1.5× for this use case) considering that only the two most demanding steps were run in parallel. Previous implementations, which lacked a clear separation of responsibilities and relied on monolithic agents, instead showed undesired behaviors like infinite loops and hallucinations.</p>
<p>For the development of <a href="https://github.com/org-carmelolg-private-labs/agentic-totchef">Agentic TotChef</a>, I used Python, but <em>agentic design patterns</em> are language-agnostic concepts that can be applied to any type of agent or AI model.</p>
<p>This project also gave me the chance to explore the world of <em>vibe coding</em> more deeply, thanks to the valuable insights of <strong><a href="https://gregoriolagamba.github.io/">@gregoriolagamba</a></strong>, Solution Architect at Plenitude, who introduced me to agentic programming tools directly on GitHub.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://carmelolg.github.io/it-is-worth-a-coke/tags/ai/">AI</a></li>
      <li><a href="https://carmelolg.github.io/it-is-worth-a-coke/tags/genai/">GenAI</a></li>
      <li><a href="https://carmelolg.github.io/it-is-worth-a-coke/tags/agent/">Agent</a></li>
      <li><a href="https://carmelolg.github.io/it-is-worth-a-coke/tags/ollama/">Ollama</a></li>
      <li><a href="https://carmelolg.github.io/it-is-worth-a-coke/tags/python/">Python</a></li>
    </ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>© <a href="https://carmelolg.github.io/">carmelolg</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
